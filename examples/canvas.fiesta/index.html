<!doctype html><title>Example of firework.js</title>

<script src="../../src/core.js"></script>
<script src="../../src/emitter.js"></script>
<script src="../../src/particle.js"></script>
<script src="../../src/effect.js"></script>
<script src="../../src/spawner.js"></script>
<script src="../../src/shape.js"></script>
<script src="../../src/vector.js"></script>

<script src="../plugins/effect.base.js"></script>
<script src="../plugins/effect.age.js"></script>
<script src="../plugins/spawner.rate.js"></script>
<script src="../plugins/shape.sphere.js"></script>
<script src="../plugins/effect.applyForce.js"></script>
<script src="../plugins/effect.init2shapes.js"></script>
<script src="../plugins/effect.shape.box.js"></script>
<script src="../plugins/effect.dieifcontained.js"></script>

<body><script>
	var canvas	= document.createElement('canvas');
	document.body.appendChild(canvas);
	canvas.width	= window.innerWidth;
	canvas.height	= window.innerHeight;
	// canvas.style
	canvas.style.position	= "absolute";
	canvas.style.left	= 0;
	canvas.style.top	= 0;
	// setup ctx
	var ctx		= canvas.getContext('2d');
	
	
	ctx.fillStyle	= 'rgba(0,0,0,1)';
	ctx.fillRect(0, 0, canvas.width, canvas.height);
	
	ctx.translate(window.innerWidth/2, window.innerHeight/2)

	var emitter	= new Fireworks.Emitter({
		nParticles	: 300
	});
	emitter.setSpawner(new Fireworks.SpawnerRate(1));
	emitter.pushBase().pushAge(2);
	
	emitter.pushInit2Shapes({
		origin	: Fireworks.createBox(0, 0, 0, 10, 10, 0),
		target	: Fireworks.createBox(0, -600, 0, 600, 400, 400),
		speed	: 5
	});

	Fireworks.createEffect().onUpdate(function(particle){
		var ctx	= emitter.getParticleData(particle, 'xBase')
		ctx.acceleration.y	+= 0.0005;
	}).pushTo(emitter);

	Fireworks.createEffect().onCreate(function(particle){
		emitter.setParticleData(particle, 'xSize', {
			size	: 1.0
		});
	}).onBirth(function(particle){
		var ctx		= emitter.getParticleData(particle, 'xSize')
		ctx.size	= 3.0;
	}).onUpdate(function(particle){
		var ctx		= emitter.getParticleData(particle, 'xSize')
		ctx.size	+= 0.05;
	}).pushTo(emitter);

	Fireworks.createEffect({
		shape	: Fireworks.createBox(0, 5000, 0, 10000, 10000, 10000)
	}).onUpdate(function(particle){
		var xBase	= emitter.getParticleData(particle, 'xBase');
		var position	= xBase.position;
		//console.log("position.y", position.y)
		if( this.opts.shape.contains(position) ){
			//console.log("killed")
			emitter.killParticle(particle);
		}
	}).pushTo(emitter);

	emitter.start();

	setInterval(function(){
		var deltaTime	= 1/60;
		emitter.update(deltaTime);
		render(emitter);
	}, 1000/60);

	function render(emitter){
		// clear the screen
		ctx.save();
		ctx.globalAlpha = 0.025;
		ctx.fillStyle = "rgb(0,0,0)";
		ctx.fillRect(-canvas.width/2, -canvas.height/2, canvas.width, canvas.height);
		ctx.restore();
		// set the fillStyle of the particles
		ctx.fillStyle	= 'rgba(127,0,255, 0.2)';
		emitter.liveParticles().forEach(function(particle){
			var position	= particle.xBase.position;
			var radius	= particle.xSize.size;
console.log("raidus", radius)
			ctx.beginPath();
			ctx.arc(position.x, position.y, radius, 0, Math.PI*2, true); 
			ctx.fill();			
		});
	}
</script></body>