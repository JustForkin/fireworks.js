<!doctype html><title>Example of firework.js</title>
<script src="../vendor/tquery-bundle.js"></script>

<script src="../../src/core.js"></script>
<script src="../../src/emitter.js"></script>
<script src="../../src/particle.js"></script>
<script src="../../src/effect.js"></script>
<script src="../../src/spawner.js"></script>
<script src="../../src/shape.js"></script>
<script src="../../src/vector.js"></script>
<script src="../../src/lineargradient.js"></script>


<script src="../vendor/dat.gui.js"></script>
<script src="../plugins/fireworks.datgui4emitter.js"></script>

<script src="../plugins/spawner.rate.js"></script>
<script src="../plugins/shape.box.js"></script>
<script src="../plugins/shape.sphere.js"></script>
<script src="../plugins/shape.point.js"></script>

<script src="./effect.friction.js"></script>
<script src="./effect.lifetime.js"></script>
<script src="./effect.position.js"></script>
<script src="./effect.randomvelocitydrift.js"></script>
<script src="./effect.rendertocanvas.js"></script>
<script src="./effect.rendertothreejsobject3d.js"></script>
<script src="./effect.rendertothreejsparticlesystem.js"></script>
<script src="./effect.velocity.js"></script>


<body><script>
	var world	= tQuery.createWorld().boilerplate().start();
		
	var object	= tQuery.createTorus().addTo(world).rotateX(Math.PI/2).scale(1.25);
					
	var texture	= THREE.ImageUtils.loadTexture( "../assets/images/cloud10.png");
	

	// create the emitter
	var emitter	= Fireworks.createEmitter({nParticles : 400})
		.useSpawnerSteadyRate(1)
		.effectsStackBuilder()
			.position(Fireworks.createShapeBox(0, 0, 0, 0.1, 0.2, 0.1))
			.velocity(Fireworks.createShapeBox(0, 1, 0, 0.08, 0.0001, 0.08))
			.friction(1)
			.lifeTime(3,4)
			.createEffect()
				.onBirth(function(particle){
					var object3d	= particle.get('threejsObject3D').object3d;
				 	var scale	= 1/300 * (Math.random() * 0.2 + 0.9);
				 	object3d.scale.set(scale, scale, scale);
				 	
					object3d.color.setHex( 0x010101*Math.floor(255*(Math.random()*0.1+0.3)) );
					object3d.color.setHex( 0x010101 );
					//object3d.rotation	= Math.random() * Math.PI*2;
				}).back()
			.createEffect('scaleMul', {
					factor	: 1 + 0.005
				}).onUpdate(function(particle){
					var object3d		= particle.get('threejsObject3D').object3d;
					object3d.scale.multiplyScalar(this.opts.factor);
				}).back()
			.createEffect('frictionSlowDown', {
					gradient	: Fireworks.createLinearGradient()
								.push(0.0, 1.00)
								.push(0.5, 0.99)
								.push(0.6, 0.99)
								.push(0.9, 0.96)
								.push(1.0, 0.96)
				}).onUpdate(function(particle){
					var object3d		= particle.get('threejsObject3D').object3d;
					var pFriction		= particle.get('friction');
					var normalizedAge	= particle.get('lifeTime').normalizedAge();
					pFriction.value		= this.opts.gradient.get(normalizedAge);	
				}).back()
			.createEffect('opacity', {
					gradient	: Fireworks.createLinearGradient()
								.push(0.0, 0.00)
								.push(0.2, 1.00)
								.push(0.8, 1.00)
								.push(1.0, 0.00)			
				}).onUpdate(function(particle){
					var object3d		= particle.get('threejsObject3D').object3d;
					var normalizedAge	= particle.get('lifeTime').normalizedAge();
					object3d.opacity	= this.opts.gradient.get(normalizedAge);	
				}).back()
			.renderToThreejsObject3D({
				create	: function(){
					var object3d	= new THREE.Sprite({
						map			: texture,
						useScreenCoordinates	: false,
					});
					world.add(object3d)
					return object3d;		
				}	
			})
			.back()
		.start();


	new Fireworks.DatGui4Emitter(emitter);

	world.loop().hook(function(delta, now){
		emitter.update(delta).render();
	})
</script></body>











