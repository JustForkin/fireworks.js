var Fireworks={Emitter:function(a){this._nParticles=void 0!==a.nParticles?a.nParticles:100;this._particles=[];this._spawner=null;this._effects=[];this._onUpdated=null}};Fireworks.Emitter.prototype.destroy=function(){this._effects.forEach(function(a){a.destroy()});this._spawner&&this._spawner.destroy();this._particles.forEach(function(a){a.destroy()})};Fireworks.Emitter.prototype.effects=function(){return this._effects};Fireworks.Emitter.prototype.particles=function(){return this._particles};
Fireworks.Emitter.prototype.liveParticles=function(){return this._liveParticles};Fireworks.Emitter.prototype.deadParticles=function(){return this._deadParticles};Fireworks.Emitter.prototype.addEffectBase=function(){this._effects.push(new Fireworks.EffectBase(this));return this};Fireworks.Emitter.prototype.addEffectAge=function(){this._effects.push(new Fireworks.EffectAge(this));return this};Fireworks.Emitter.prototype.setSpawnerRate=function(){this._spawner=new Fireworks.SpawnerRate;return this};
Fireworks.Emitter.prototype.start=function(){console.assert(this._spawner,"a spawner MUST be set");console.assert(0<this._effects.length,"Some effects MUST be set");this._particles=Array(this._nParticles);for(var a=0;a<this._nParticles;a++)this._particles[a]=new Fireworks.Particle;this._liveParticles=[];this._deadParticles=this._particles.slice(0);this._started=!0;this._effects.forEach(function(a){a.onCreate&&this._particles.forEach(function(c){a.onCreate(c)})}.bind(this));return this};
Fireworks.Emitter.prototype.update=function(a){this._spawner.update(this,a);this._effects.forEach(function(b){b.onUpdate&&this._liveParticles.forEach(function(c){b.onUpdate(c,a)})}.bind(this))};Fireworks.Emitter.prototype.killParticle=function(a){var b=this._liveParticles.indexOf(a);console.assert(-1!==b);this._liveParticles.splice(b,1);this._deadParticles.push(a)};
Fireworks.Emitter.prototype.spawnParticle=function(){var a=emitter.deadParticles().pop();emitter.liveParticles().push(a);emitter.effects().forEach(function(b){b.onBirth&&b.onBirth(a)}.bind(this))};Fireworks.Spawner=function(){};Fireworks.Particle=function(){};Fireworks.Effect=function(){};
